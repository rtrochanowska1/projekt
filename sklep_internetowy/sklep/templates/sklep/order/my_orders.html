{% extends "sklep/base.html" %}
{% block title %}Moje zamówienia{% endblock %}
{% block content %}
<style>
  .wrap{max-width:1000px;margin:20px auto;}
  .card{background:#fff;border:1px solid #e0e0e0;border-radius:12px;padding:16px;box-shadow:2px 2px 10px rgba(0,0,0,0.05);margin-bottom:14px;}
  .muted{color:#777;}
  table{width:100%;border-collapse:collapse;margin-top:8px;}
  th,td{padding:8px;border-bottom:1px solid #eee;text-align:left;}
  .right{text-align:right;}
  .pill{display:inline-block;padding:4px 8px;border-radius:999px;border:1px solid #ddd;font-size:12px;}
</style>

<div class="wrap">
  <h2>Moje zamówienia</h2>

  {% if not orders %}
    <div class="card"><p class="muted">Nie masz jeszcze żadnych zamówień.</p></div>
  {% else %}
    {% for o in orders %}
      <div class="card">
        <div>
          <strong>Zamówienie #{{ o.id }}</strong>
          <span class="muted"> | {{ o.date_ordered }}</span>
          {% if o.is_paid %}<span class="pill">opłacone</span>{% else %}<span class="pill">nieopłacone</span>{% endif %}
          {% if o.transaction_id %}<span class="muted"> | transakcja: {{ o.transaction_id }}</span>{% endif %}
        </div>

        <table>
          <thead>
            <tr>
              <th>Produkt</th>
              <th>Ilość</th>
              <th class="right">Cena</th>
              <th class="right">Razem</th>
            </tr>
          </thead>
          <tbody>
            {% for it in o.items.all %}
              <tr>
                <td>{{ it.coffee.name|default:"(usunięty produkt)" }}</td>
                <td>{{ it.quantity }}</td>
                <td class="right">{{ it.price_at_order }} PLN</td>
                <td class="right">{{ it.total_price }} PLN</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endfor %}
  {% endif %}
</div>
{% endblock %}